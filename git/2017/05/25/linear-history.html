<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Linear History | RoleModel Software Best Practices</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Linear History" />
<meta name="author" content="Jeff Terrell" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="At RoleModel we commend the practice of keeping git histories linear. This document discusses why." />
<meta property="og:description" content="At RoleModel we commend the practice of keeping git histories linear. This document discusses why." />
<link rel="canonical" href="https://rolemodel.design/git/2017/05/25/linear-history.html" />
<meta property="og:url" content="https://rolemodel.design/git/2017/05/25/linear-history.html" />
<meta property="og:site_name" content="RoleModel Software Best Practices" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-25T04:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Linear History" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jeff Terrell"},"dateModified":"2017-05-25T04:00:00+00:00","datePublished":"2017-05-25T04:00:00+00:00","description":"At RoleModel we commend the practice of keeping git histories linear. This document discusses why.","headline":"Linear History","mainEntityOfPage":{"@type":"WebPage","@id":"https://rolemodel.design/git/2017/05/25/linear-history.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://rolemodel.design/assets/images/logo.svg"},"name":"Jeff Terrell"},"url":"https://rolemodel.design/git/2017/05/25/linear-history.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body class="app-with-sidebar"><div id="sidebar-menu" class="sidebar-primary sidebar--drawer sidebar--mobile-friendly">
  <div class="sidebar-menu-button-container">
    <span class="sidebar-menu-button material-symbols-outlined icon--x-large">close</span>
  </div>
  <a class="sidebar__brand" href="/">
    <img src="/assets/images/logo.svg">
  </a>

  <div class="sidebar__content sidebar__content--start">
    <div class="sidebar__section-title">Introduction</div>
    <a class="sidebar__item " href="/">
      <span class="material-symbols-outlined sidebar__item-icon" title="home">home</span>
      <div class="sidebar__item-label">Home</div>
    </a><a class="sidebar__item "
      href="/about/">
      <span class="material-symbols-outlined sidebar__item-icon" title="info">info</span>
      <div class="sidebar__item-label">About</div>
    </a><a class="sidebar__item " href="/all-posts">
      <span class="material-symbols-outlined sidebar__item-icon" title="feed">feed</span>
      <div class="sidebar__item-label">All Posts</div>
    </a>

    <div class="sidebar__section-title">Topics</div>
    <a class="sidebar__item "
      href="/rails/">
      <span class="material-symbols-outlined sidebar__item-icon" title="train">train</span>
      <div class="sidebar__item-label">Rails</div>
    </a><a class="sidebar__item active"
      href="/git/">
      <span class="material-symbols-outlined sidebar__item-icon" title="code">code</span>
      <div class="sidebar__item-label">Git</div>
    </a><a class="sidebar__item "
      href="/patterns/">
      <span class="material-symbols-outlined sidebar__item-icon" title="texture">texture</span>
      <div class="sidebar__item-label">Patterns</div>
    </a><a class="sidebar__item "
      href="/support/">
      <span class="material-symbols-outlined sidebar__item-icon" title="support_agent">support_agent</span>
      <div class="sidebar__item-label">Support</div>
    </a><a class="sidebar__item "
      href="/devops/">
      <span class="material-symbols-outlined sidebar__item-icon" title="dns">dns</span>
      <div class="sidebar__item-label">DevOps</div>
    </a><a class="sidebar__item "
      href="/presentations/">
      <span class="material-symbols-outlined sidebar__item-icon" title="co_present">co_present</span>
      <div class="sidebar__item-label">Presentations</div>
    </a><a class="sidebar__item "
      href="/testing/">
      <span class="material-symbols-outlined sidebar__item-icon" title="bug_report">bug_report</span>
      <div class="sidebar__item-label">Testing</div>
    </a></div>
</div>
<div id="app-body" class="app-body"><header class="app__header" role="banner">
  <div class="app__header-navigation">
    <span class="sidebar-menu-button material-symbols-outlined icon--x-large">menu</span>
  </div>
  <div class="app__header-title">
    <span>RoleModel Software Best Practices</span>
  </div>
  <div class="app__header-actions"></div>
</header>
<div class="app__content">
      <div class="post-body">
  <article class="card margin-y-md full-width" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="card__header">
      <h1 class='post-title' itemprop="name headline">Linear History</h1>
      <div class="post-meta"><time class="post-meta__date" datetime="2017-05-25T04:00:00+00:00" itemprop="datePublished">May 25, 2017
        </time><p class="post-meta__data">Author: Jeff Terrell</p><p class="post-meta__data">Approver: Caleb Woods</p></div>
    </header>

    <div class="card__body" itemprop="articleBody">
      <p>At RoleModel we commend the practice of keeping git histories linear. This
document discusses why.</p>

<h2 id="two-approaches">Two approaches</h2>

<p>There are broadly two views on how to structure the history of a git repository:
merging or rebasing. The merge view exhorts thorough reliance on git’s
unprecedented ability to create and use <em>merge commits</em>, which is simply a
commit with more than one parent. The Linux kernel, which is perhaps the
flagship git project because
<a href="https://git-scm.com/book/en/v2/Getting-Started-A-Short-History-of-Git">it spawned git</a> and
because it has more activity than almost any other project, adheres to this
view. Its maintainers have been known to create “octopus merges” with more than
two parents; in fact,
<a href="https://www.destroyallsoftware.com/blog/2017/the-biggest-and-weirdest-commits-in-linux-kernel-git-history">one commit has 66 parents</a>!</p>

<p>The other view is to rely on git’s ability to <em>rebase</em> commits onto another
commit, which effectively replays the commits onto a new starting point. Using
rebase allows us to have a <em>linear</em> (or at least linearizable) history. You can
see an example of what linear vs. non-linear history looks like in
the <a href="merge-strategies#background">Merge Strategies</a> best practice.</p>

<p>As an aside, those who view the <a href="purpose-of-git">purpose of git</a> as a log
of what happened (rather than a logical history) eschew the use of history
rewriting techniques like <code class="language-plaintext highlighter-rouge">git rebase</code>, and so take the merge view.</p>

<h2 id="recommendation">Recommendation</h2>

<p>At RoleModel we recommend linear history in almost all cases. The one exception
is a very short-lived project that is unlikely to have anybody needing to
understand the history.</p>

<h2 id="considerations">Considerations</h2>

<p>The main tradeoff that we recognize is time spent creating the history vs. time
spent reading and understanding the history. For long-lived projects, we
optimize for the latter, just as we spend extra development time making the code
legible for later readers. For short-lived projects, however, it may make sense
to optimize for writing rather than reading.</p>

<p>Another consideration is how the two approaches reconcile conflicts, which
happen when git can’t figure out how to bring two histories together. In the
merge-based view, a conflict is surfaced during the merge. Resolving the
conflict once is sufficient. In a rebase, however, there is sometimes a repeated
conflict at every new commit that is being replayed. If you rebase before
squashing, as we recommend, this can become annoying fast. Git’s <code class="language-plaintext highlighter-rouge">rerere</code> option
can help with this, which <code class="language-plaintext highlighter-rouge">re</code>plays <code class="language-plaintext highlighter-rouge">re</code>corded (conflict) <code class="language-plaintext highlighter-rouge">re</code>solutions. Note
also that you may be rebasing more commits than you really need to or intend to;
the <code class="language-plaintext highlighter-rouge">--onto</code> option to <code class="language-plaintext highlighter-rouge">git rebase</code> can help with this.</p>

<p>One more subtle type of conflict is worth mentioning to illustrate how each
approach handles it. Say you’re merging a feature into the current release
branch that changes some interface in your code. Yet, since the time you
branched from the release branch, somebody else committed code that depended on
the old interface. The merging or rebasing can happen without conflicts, but the
code will be broken. In the merge approach, this will be apparent only at the
merge commit, so it’s important to run tests locally before pushing the merge
commit, even if there were no conflicts. In the rebase approach, this may be
apparent earlier in the feature branch once rebasing is finished, and one could
amend the commit that changed the interface to also change the new calling code.
But the newly rebased feature branch should be tested before fast-forward
merging into the release branch.</p>

<p>One last consideration is <a href="https://git-scm.com/docs/git-bisect">bisecting</a>. It’s
easy to understand how bisecting works with a linear history. With a non-linear
history, it’s harder to know how it works and harder to have confidence that the
bisecting process correctly identifies the point of breakage. (However, care
still must be taken not to introduce broken commits into the history, or the
bisection may get caught at that point.)</p>

    </div>

    <a class="u-url" href="/git/2017/05/25/linear-history.html" hidden></a>
  </article>

  <div class="table-of-contents">
    <p class="table-of-contents__title">Table of Contents</p>
    <ul id="table-of-contents" class="table-of-contents__nav">
<li class="table-of-contents__item table-of-contents-h2"><a href="#two-approaches">Two approaches</a></li>
<li class="table-of-contents__item table-of-contents-h2"><a href="#recommendation">Recommendation</a></li>
<li class="table-of-contents__item table-of-contents-h2"><a href="#considerations">Considerations</a></li>
</ul>
  </div>
</div>

    </div>
  </div>
</body>

</html>
